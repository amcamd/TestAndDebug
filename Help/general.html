<!DOCTYPE html>
<html>
<head>
<style>
table, th, td {
    border: 1px solid orange;
    border-collapse: collapse;
}
th, td {
    padding: 5px;
}
</style>
</head>
<body>
<h1>www sites</h1>
<p>
<table>
<tr>
    <td><a href="https://github.com/ROCmSoftwarePlatform/rocBLAS-internal">rocBLAS-internal</a>, 
        <a href="https://github.com/amcamd/rocBLAS-internal">amcamd</a></td>
    <td>Github site for rocBLAS-internal</td>
<tr>
    <td><a href="https://github.com/ROCmSoftwarePlatform/rocBLAS">rocBLAS</a>, 
        <a href="https://github.com/amcamd/rocBLAS">amcamd</a></td>
    <td>Github site for rocBLAS</td>
<tr>
    <td><a href="https://docs.amd.com/bundle/rocBLAS-User-Guide---rocBLAS-documentation/page/Linux_Install_Guide.html">rocBLAS documentation</a><br></td>
    <td>ROCm Documentation site for rocBLAS</td>
</tr><tr>
    <td><a href="https://github.com/ROCmSoftwarePlatform/Tensile">Tensile</a><br></td>
    <td>Github site for https://github.com/ROCmSoftwarePlatform/Tensile</td>
</tr><tr>
    <td><a href="https://github.com/ROCmSoftwarePlatform/hipBLAS">hipBLAS</a>, 
        <a href="https://github.com/amcamd/hipBLAS">amcamd</a><br></td>
    <td>Github site for https://github.com/ROCmSoftwarePlatform/hipBLAS</td>
</tr><tr>
    <td><a href="http://math-ci.amd.com/job/compute-rocm-dkms-no-npi-hipclang/job/precheckin/">Jenkins rocBLAS-internal hipclang</a><br></td>
    <td>Site for Jenkins Continuous Integration testing. http://math-ci.amd.com/job/compute-rocm-dkms-no-npi-hipclang-int-bkc-4/job/precheckin/job/rocBLAS-internal// </td>
</tr><tr>
    <td><a href="http://math-ci.amd.com/">Jenkins</a><br></td>
    <td>Site for Jenkins Continuous Integration testing. http://math-ci.amd.com/ </td>
</tr><tr>
    <td><a href="http://math-ci.amd.com/blue/organizations/jenkins/main%2Fweekly%2FrocBLAS-internal/pr">Jenkins weekly</a><br></td>
    <td>Jenkins weekly pipeline PRs</td>
</tr><tr>
    <td><a href="http://ontrack-internal.amd.com/issues/?filter=69690">Jira search</a><br></td>
    <td>Go to Projects, then "MLSE rocBLAS (LWPMLSE)" for rocBLAS LWPMLSE tickets</td>
</tr><tr>
    <td><a href="http://confluence.amd.com/display/MLSE/Tensile+and+rocBLAS">Confluence</a><br></td>
    <td>Confluence site for internal documents.</td>
</tr><tr>
    <td><a href="https://confluence.amd.com/display/MLSE/ROCm+5.2+Release">Status Roll Up - ROCm Releases</a><br></td>
    <td>Dates for ROCm Releases</td>
</tr><tr>
    <td><a href="https://confluence.amd.com/display/MLSE/MLSE+Libraries">Libraries dates</a><br></td>
    <td>Dates for Libraries team</td>
</tr><tr>
    <td><a href="https://github.com/ROCmSoftwarePlatform/rocJenkins">rocJenkins</a><br></td>
    <td>Github site for https://github.com/ROCmSoftwarePlatform/rocJenkins/</td>
</tr><tr>
    <td><a href="https://github.com/amcamd/TestAndDebug">TestAndDebug</a><br></td>
    <td>Site I use for any open but not official code and testing</td>
</tr><tr>
    <td><a href="http://docs.nvidia.com/cuda/cublas/#introduction">cuBLAS</a><br></td>
    <td>cuBLAS</td>
</tr><tr>
    <td><a href="https://github.com/ROCmSoftwarePlatform/hcBLAS">hcBLAS</a><br></td>
    <td>Discontinued blas library developed by MulticoreWare</td>
</tr><tr>
    <td><a href="https://github.com/AMDComputeLibraries/MLOpen">MIOpen</a><br></td>
    <td>AMD Machine Learning</td>
</tr><tr>
    <td><a href="https://bitbucket.org/multicoreware/hipcaffe">hipCaffe</a><br></td>
    <td>Port of UC.Berkeley Caffe machine learning framework</td>
</tr><tr>
    <td><a href="https://github.com/ROCmSoftwarePlatform/DeepBench">Deepbench</a><br></td>
    <td>BaiDu Research GEMM Benchmarks</td>
</tr><tr>
    <td><a href="https://github.com/ecrc/kblas-gpu">KBLAS</a><br></td>
    <td>KAUST BLAS</td>
</tr><tr>
    <td><a href="https://github.com/hyln9/GCNGEMM">hgemm gcngemm</a><br></td>
    <td>https://github.com/hyln9/GCNGEMM</td>
</tr><tr>
    <td><a href="http://32ipi028l5q82yhj72224m8j-wpengine.netdna-ssl.com/wp-content/uploads/2016/08/AMD_GCN3_Instruction_Set_Architecture_rev1.1.pdf">Reference Guide</a><br></td>
    <td>Reference Guide, Gen 3 gfx 2016</td>
</tr><tr>
    <td><a href="https://github.com/CLRX/CLRX-mirror/wiki/GcnIsa">AMD GCN ISA</a><br></td>
    <td>GCN instruction description</td>
</tr><tr>
    <td><a href="http://developer.amd.com/wordpress/media/2017/08/Vega_Shader_ISA_28July2017.pdf">Vega10 ISA</a><br></td>
    <td>Instruct Set Architecture for Vega 10</td>
</tr><tr>
    <td><a href="https://code.visualstudio.com/">Code Visual Studio</a><br></td>
    <td>useful for debugging python code on Linux</td>
</tr><tr>
    <td><a href="https://cmake.org/cmake-tutorial/">Cmake Tutorial</a><br></td>
    <td>Introductory Cmake tutorial</td>
</tr><tr>
    <td><a href="https://www.docker.com">https://www.docker.com</a><br></td>
    <td>Information on docker containers</td>
</tr><tr>
    <td><a href="https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet">Editing Github Wiki </a><br></td>
    <td>Useful for editing Github Wiki documents</td>
</tr><tr>
    <td><a href="https://amdcloud.sharepoint.com/sites/connect/teams/hr/Pages/HRT/USA_MyHR_Home.aspx">MyHr</a><br></td>
    <td>Access to AskHR, myAMD, TalentConnect, HR Connect, AMD Connect</td>
</tr><tr>
    <td><a href="https://amdcloud.sharepoint.com/sites/connect/news-events/news/Pages/New-AskHR-Platform.aspx">AskHr</a><br></td>
    <td>AskHR Platform</td>
</tr><tr>
    <td><a href="http://confluence.amd.com/display/MLSE/Onboarding">On-boarding</a><br></td>
    <td>Group on-boarding</td>
</tr><tr>
    <td><a href="https://confluence.amd.com/display/MLSE/MLSE+Library+Windows+Support">MLSE Library Windows Support</a><br></td>
    <td>Windows support</td>
</tr><tr>
    <td><a href="http://confluence.amd.com/display/MLSE/Servers+for+Math+Libraries+Team">machines</a><br></td>
    <td>Servers for Math Libraries Team</td>
</tr><tr>
    <td><a href="https://confluence.amd.com/pages/viewpage.action?spaceKey=MLSE&title=hipBLAS+Performance+Script">hipBLAS Perf Script</a><br></td>
    <td>hipBLAS Performance Script</td>
</tr><tr>
    <td><a href="https://confluence.amd.com/display/MLSE/rocBLAS+Performance+Script">rocBLAS Perf Script</a><br></td>
    <td>rocBLAS Performance Script</td>
</tr><tr>
    <td>Mainline <a href="http://gerrit-git.amd.com/plugins/gitiles/compute/ec/manifest/+/refs/heads/master-no-npi/compute-rocm-libs.xml">manifest</a> <a href="http://rocm-ci.amd.com/job/compute-rocm-dkms-no-npi-hipclang/">pipeline</a> <a href="https://confluence.amd.com/display/MLSE/Manifest+Controlled+Mainline+Entry">instructions</a><br></td>
    <td>Mainline manifest, pipeline, and instructions</td>
</tr><tr>
    <td><a href="https://confluence.amd.com/display/MLSE/Software+Release+Process">process</a> <a href="https://confluence.amd.com/display/MLSE/Feature+Complete+Checklist+ROCm+5.6">checklist</a></td>
    <td>Software Release Process and checklist</td>
</tr><tr>
    <td><a href="http://rocm-ci.amd.com/job/compute-rocm-rel-5.3/lastSuccessfulBuild/artifact/manifest.xml">Release manifest</a><br></td>
    <td>Manifest for ROCm 5.3 release</td>
</tr><tr>
    <td>[teams][MLSE Libraries][A100 servers sharing]</td>
    <td>A100 time reservation</td>
</tr>
</table>


<p>


<h1>Ubuntu setup</h1>

<ul>
  <li><code>uname -a</code>
    <ul>
      <li>print system information, all
    </ul>
  <li><code>lsb_release -a</code>
    <ul>
      <li>print distribution-specific information (Linux Standard Base)
    </ul>
  <li><code>dpkg --list | grep -i rocm</code>
    <ul>
      <li>get rocm package version
    </ul>
  <li><code>apt-cache depends hcc</code>
    <ul>
      <li>lists packages required by hcc
    </ul>
  <li><code>/opt/rocm/bin/rocm_agent_enumerator, /opt/rocm/bin/rocminfo, /opt/rocm/bin/hipconfig
      </code>
    <ul>
      <li>device information, rocm information, hip information
    </ul>
  </li>
  <li><code>lspci</code>
    <ul>
      <li>list all PCI devices
    </ul>
  <li><code>sudo apt-get update</code>
    <ul>
      <li>APT package handling utility (Advanced Package Tool).
      <li>Downloads the package lists from the repositories and "updates" them to get information on the newest versions of packages and their dependencies.
    </ul>
  <li><code>sudo apt-get upgrade</code>
    <ul>
      <li>fetch new versions of packages existing on the machine if APT knows about these new versions by way of apt-get update
    </ul>
  <li><code>ip route get 8.8.8.8 | awk '{print $NF; exit}'</code>
    <ul>
      <li>get the ip address, alternative command is ifconfig
    </ul>
  <li><code>sudo lsblk, sudo blkid, ls -l /dev/disk/bu-uuid, </code>
    <ul>
      <li>disk information
    </ul>
  </li>
  <li><code>sudo useradd --create-home -G sudo,video --shell /bin/bash &lt;username&gt;</code>
    <ul>
      <li>adduser
    </ul>
  </li>
  <li><code>sudo passwd &lt;username&gt;</code>
    <ul>
      <li>change password
    </ul>
  </li>
  <li><code>groups</code>
      <ul>
            <li>check membership of groups</li>
      </ul>
  </li>
  <li><code>sudo usermod -a -G video achapman</code>
      <ul>
          <li>Adding achapman to video group</li>
          <li> <font color="red">need to log out and log back in</font></li>
      </ul>
  </li>
  <li><code>/opt/rocm/hip/bin/hipcc -save-temps bit_extract.cpp -o bit_extract</code>
    <ul>
        <li>produce assembly isa .s files</li>
    </ul>
  </li>
  <li><code>export AMD_LOG_LEVEL=3  replaces  export HCC_PROFILE=2</code>
    <ul>
        <li>list hip kernels at runtime</li>
    </ul>
  </li>
  <li><code>c++filt -n _ZN7rocblas13device_mallocEm</code>
    <ul>
        <li>extract c++ function name from mangled name</li>
    </ul>
  </li>
  <li><code>systemctl suspend</code>
    <ul>
      <li>suspend ubuntu terminal</li>
    </ul>
  </li>
  <li><code>export LD_LIBRARY_PATH=/opt/rocm/lib</code>
    <ul>
        <li>for message  libmcwamp_cpu.so: cannot open shared object file</li>
    </ul>
  </li>
  <li><code>/opt/rocm/bin/rocm_agent_enumerator</code>
      <ul>
          <li>to get device information</li>
      </ul>
  </li>
  <li><code>gsettings set org.gnome.desktop.wm.codeferences focus-mode 'mouse'</code>
    <ul>
      <li>focus follows mouse
    </ul>
  </li>
  <li><pre>Two changes to prevent terminal freeze</pre>
    <ul>
      <li>In the application <code>Software & Updates</code>,<br> 
          go to <code>Additional Drivers</code><br> 
          Under the <code>Unknown: Unknown</code> tag select the radio button for<br>
          <code>Using Processor microcode firmware 
            for AMD CPUs from amd64-microcode (proprietary)</code> 
      <li><code>sudo vim /etc/default/grub</code><br>
          Find the line <code>GRUB_CMDLINE_LINUX_DEFAULT="quiet splash"</code><br>
          change it to <code>GRUB_CMDLINE_LINUX_DEFAULT="quiet splash intel_idle.max_cstate=1"</code>
    </ul>
  </li>

</ul>

<h1>ROCm installation</h1>
<p>
If you get the following error message it may be fixed by reinstalling ROCm
<pre> <code>
  HSA Error:  Incompatible kernel and userspace, AMD Radeon VII disabled. Upgrade amdgpu.
  HSA Error:  Incompatible kernel and userspace, AMD Radeon VII disabled. Upgrade amdgpu.
  Query device error: cannot get device count

  Invalid Device ID
</code></pre>
</p>

<p>
To install ROCm 5.4 follow <a href="https://docs.amd.com/bundle/ROCm-Installation-Guide-v5.4/page/How_to_Install_ROCm.html#_How_to_Install">Instructions</a>. Make sure you have the version or ROCm you want. The Instructions in the link are for is ROCm 5.4.
</p>

Below is from instructions


<h3>Get Ubuntu version with</h3>
<code>
> uname -m && cat /etc/*release
</code>

<h3>Get installer</h3>
<p>For Ubuntu 20.04
<pre> <code>
  > sudo apt-get update
  > wget https://repo.radeon.com/amdgpu-install/5.4/ubuntu/focal/amdgpu-install_5.4.50400-1_all.deb
  > sudo apt-get install ./amdgpu-install_5.4.50400-1_all.deb
</code> </pre>
</p>

<p>For Ubuntu 22.04
<pre> <code>
  > sudo apt-get update
  > wget https://repo.radeon.com/amdgpu-install/5.4/ubuntu/jammy/amdgpu-install_5.4.50400-1_all.deb
  > sudo apt-get install ./amdgpu-install_5.4.50400-1_all.deb
</code> </pre>
</p>

<h3>Uninstall previous ROCm</h3>
<p>
<pre> <code>
  > amdgpu-install --uninstall
</code></pre>
</p>

<h3>Install ROCm 5.4</h3>
<p> 
<pre><code>
  > sudo amdgpu-install --usecase=rocm

  Next reboot
</code></pre></p>


<p>
If it cannot find dkms.conf you may need to look in <code>/usr/src</code>
<pre> <code>
  sudo ln -s  /usr/src/amdgpu-5.18.13-1510348.20.04/ source
</code></pre>
</p>

<h1>VIM</h1>
<dl>
    <dt>To change to color scheme that allows for viewing comments</dt>
    <dd><code> :color desert</code></dd>
    <dd>or add <code>:color</code> desert to your ~/.vimrc</dd><br>

    <dt>To substitute new line use \r. For example: </dt>
    <dd><code>1,$s/newline/\r/</code></dd><br>

    <dt>To insert tab when expandtab option is ON: </dt>
    <dd><code>i , &lt;CTRL&gt;&lt;v&gt; , &lt;tab&gt;  (i is for insert mode)</code></dd><br>

    <dt>Visual Block Mode: </dt>
    <dd>Ctrl V, move cursor to highlight block, y or d (for yank or delete)</dd> 
    <dd>move cursor to put block, p (for put)</dd><br>

    <dt>split windows</dt>
    <dd>
        <table>
            <tr>
                <td><code> :split filename </code></td>
                <td> split window and load filename </td>
            </tr>
            <tr>
                <td><code> ctrl-w, ctrl-w </code></td>
                <td> move cursor to another window </td>
            </tr>
        </table>
    </dd> 
</dl>

<h1>Excel row-by-row conditional formatting</h1>
<p>Select (or high-light) the block of rows and columns
<p>Select &lt;HOME&gt;&lt;Conditional Formatting&gt;&lt;New Rule&lt;Use a formula to determine which cells to format&gt;
<p>To get the min values  =A1=MIN($A1:$C1)
<p>Select &lt;Format&gt;, choose a Fill color


<h1>GitBucket</h1>
<table>
<tr>
    <td>user.name</td>	<td>amcamd</td>
</tr><tr>
    <td>user.email</td>           <td>andrew.chapman@amd.com</td>
</tr>
</table>

<h1>GitHub</h1>
<table>
<tr>
    <td>user.name</td>	<td>amcamd</td>
</tr><tr>
    <td>user.email</td>           <td>andrew.chapman@amd.com</td>
</tr>
</table>

<h4>using SSH key</h4>
<ul>
    <li>follow instructions at the following link to
    <ul>
        <li>generate a key</li>
        <li>add ssh key to the ssh-agent</li>
        <li>add the ssh key to Github account</li>
    </ul>
<a href="https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent#generating-a-new-ssh-key">Generating a new SSH key and adding it to the ssh-agent</a>
    </li>
    <li> Enalbe SSO on ssh keys. This is in your github account under [settings] [SSH and GPG keys]</li>
    <li> <code>git clone git@github.com:ROCmSoftwarePlatform/rocBLAS-internal.git</code></li>
    <li> You may need to add the following to ~/.ssh/config</li>
<pre>
Host github.com
     Hostname ssh.github.com
     Port 443
</pre>
</ul>

<h1>Useful Git commands</h1>
<h4>By-passing the hook for a commit</h4>
<code> git commit --no-verify</code>
<h4>List all commmits between two hashes</h4>
<code> git log --pretty=format:"%an%x09|%s" 8a77094..020e919</code> 
<h4>Create a tag</h4>
<ul>
    <li><code>git tag &lt;tagname&gt;</code></li>
    <li><code>git push origin --tags</code></li>
</ul>

<h4>lola alias, add to ~/.gitrc</h4>
<pre>
[alias]
        lol = log --graph --decorate --pretty=oneline --abbrev-commit
        lola = log --graph --decorate --pretty=oneline --abbrev-commit --all
[color]
        branch = auto
        diff = auto
        interactive = auto
        status = auto
</pre>
<h4>Add modified and deleted files</h4>
<code>git add -u</code>
<h4>Undo the last commit</h4>
<ul>
    <li> <code>git reset --hard HEAD~1</code></li>
        <ul>
            <li>--hard discards changes</li>
        </ul>
    <li> <code>git reset --soft HEAD~1</code></li>
        <ul>
            <li>--soft preserves changes, and you may be able to <code>git stash</code> and <code>git stach pop</code> them.</li>
        </ul>
    <li><code>git push --force-with-lease</code>
</ul>

<h4>Get upstream branch into local repository then into origin</h4>
<ul>
    <li> <code>git fetch upstream</code></li>
    <li> <code>git checkout -b new_local_branch_name upstream/upstream_branch_name</code></li>
        <ul>
            <li>gets upstream_branch_name into local repository</li>
            <li>have only tried this where new_local_branch_name == upstream_branch_name</li>
        </ul>
    <li> <code>git push -u origin new_local_branch_name</code></li>
        <ul>
            <li>pushes new_local_branch_name from local repository to origin</li>
        </ul>
    <li><code>git push --force-with-lease</code>
</ul>

<h4>Configuring a remote for a fork</h4>
<ul>
<li><pre>
===: git remote -v
<samp>
origin	https://github.com/amcamd/rocBLAS.git (fetch)
origin	https://github.com/amcamd/rocBLAS.git (push)
</samp></pre>

<li><pre>
===: git remote add upstream https://github.com/ROCmSoftwarePlatform/rocBLAS
</pre>

<li><pre>
===: git remote -v
<samp>
origin	https://github.com/amcamd/rocBLAS.git (fetch)
origin	https://github.com/amcamd/rocBLAS.git (push)
upstream	https://github.com/ROCmSoftwarePlatform/rocBLAS (fetch)
upstream	https://github.com/ROCmSoftwarePlatform/rocBLAS (push)
</samp>
</pre>
</ul>


<h4>Tracking a remote branch</h4>
For the error when running <code>git checkout &lt;BRANCH_NAME&gt;</code>
<ul>
    <li><code>git remote update</code></li>
    <li><code>git fetch </code></li>
    <li><code>git checkout --track origin/&lt;BRANCH-NAME&gt;</code></li>
</ul>


<h4>List commits between hashes</h4>
<code>git log --pretty=format:"%an%x09|%s" a272ad8e78c45261b58939e05add58aaf04b75be..020e91969485333dabc0751e66a80de726cabdfa</code>

<h4>Syncing a fork</h4>
<ul>
<li><pre>
===: git fetch upstream
<samp>
remote: Counting objects: 1, done.
remote: Total 1 (delta 0), reused 0 (delta 0), pack-reused 0
Unpacking objects: 100% (1/1), done.
From https://github.com/ROCmSoftwarePlatform/rocBLAS
 * [new branch]      develop    -> upstream/develop
 * [new branch]      master     -> upstream/master
</samp></pre>

<li><pre>
===: git checkout develop
<samp>
Already on 'develop'
Your branch is up-to-date with 'origin/develop'.
</samp></pre>

<li>Alternative 1<pre>
===: git merge upstream/develop
<samp>
Updating db0918e..e4bd4ae
Fast-forward
</samp></pre>

<li>Alternative 2:
<pre>
===: git rebase upstream/develop develop
<samp>
First, rewinding head to replay your work on top of it...
Fast-forwarded develop to upstream/develop.
</samp></pre>

<li>Alternative 3, Merge strategy favors upstream/develop:
<pre>
===: git rebase -s recursive -X ours upstream/develop develop
</pre>

<li>To get changes from local copy back into origin/develop:
<pre>
===: git push
</pre>
</ul>

<h4>Patch</h4>
<ul>
<li>To generate a patch from the topmost n commits from a specific sha1 hash:
<pre>
===:git format-patch -&lt;n&gt; &lt;SHA1&gt;
</pre>

<li>for example to generate a patch from the most recent commit to HEAD:
<pre>
===:git format-patch -1 HEAD
</pre>

<li>To check a patch and then apply it without committing changes:
<pre>
===: git apply --check name.patch
===: git apply name.patch
</pre>

<li>To reverse the patch:
<pre>
===: git apply --reverse name.patch
</pre>
</ul>

<h4>Revert</h4>
<ul>
<li><code>git revert &lt;oldest_commit_hash&gt;..&lt;latest_commit_hash&gt; </code>

<li>A solution that keeps no traces of the "undo". NOTE: don't do this 
if someone allready pulled your change (I would use this only on my personal repo)
<pre>
git reset &lt;previous label or sha1&gt;
</pre>

<li>this will re-checkout all the updates locally (so git status will 
list all updated files). Then you "do your work" and re-commit your 
changes (Note: this step is optional)
<pre>
git commit -m "blabla"
</pre>

<li>At this moment your local tree differs from the remote. The following
will push and force remote to consider this push and remove the previous one:
<pre>
git push -f
</pre>


<li>!! watch-out some tags may still be pointing removed commit !!
</ul>

<h4>Merge or "squash" multiple commits into one</h4>
<ul>
<li>To list commits: <code>git log --pretty=oneline</code>

<li>To merge last 5 commits: <code>git rebase -i HEAD~5</code>

<li>In editor change all but oldest commit from pick to squash. 
<li>Quit editor, and add commit 
comment in next editor. 
<li>If you have already pushed commits then force push with:

<pre>git push --force-with-lease    (or git push origin branch-name --force-with-lease)</pre>
</ul>

<h4>ours, theirs merge strategy</h4>
<ul>
	<li> <code>git merge branchA -X ours</code> This will choose code in current branch to resolve any merge conflict</li>
	<li> <code>git merge branchA -X theirs</code> This will choose code in branchA to resolve any merge conflict</li>
</ul>


<h4>Avoid cherry-pick</h4>

See reference <a href="http://www.draconianoverlord.com/2013/09/07/no-cherry-picking.html">If you cherry pick, your branch model is wrong</a>. To make a hot fix branch off merge-base when master and develop have moved on: 
<pre><code>git checkout -b hot_fix_branch $(git merge-base origin/release origin/develop)</code></pre>
</p>

<h4>pull request from cherry-pick commit</h4>

<p>See link for rebase after cherry-pick 
<ul>
    <li><a href="https://davitenio.wordpress.com/2008/09/27/git-merge-after-git-cherry-pick-avoiding-duplicate-commits/">git merge after git cherry-pick</a></li>
    <li><a href="https://stackoverflow.com/questions/14486122/how-does-git-merge-after-cherry-pick-work">How does git merge after cherry-pick work</a></li>
</ul>

<p>You need to basically create a new branch upstreamDevelop & cherry-pick the commits you want to add to it.

<pre>git remote add upstream &lt;git repository&gt;</pre>

<pre>git remote update</pre>

<p>create new branch upstreamDevelop that is copy of upstream/develop
<pre>git checkout -b upstreamDevelop upstream/develop</pre>

<p>get the commit (or commits) you want
<pre>git cherry-pick &lt;SHA hash of commit&gt;</pre>

<p>to push the new branch upstreamDevelop to origin</pre>
<pre>git push origin upstreamDevelop</pre>

<p>You will now see new branch upstreamDevelop in your "origin" repositiory at githup

<h4>Changing a commit message</h4>
<p>For the latest commit
<ul>
<li><code>git commit --amend</code>
<li>If commit has been pushed, force push with:  <code>git push --force-with-lease</code>
</ul>

<p>For an older commit, say second last
<ul>
<li><code>git rebase -i HEAD~2</code>
<li>change the text from <code>pick</code> to <code>edit</code> in the message you want to change
<li>Then:
<ul>
<li><code>git commit --amend</code>

<li><code>git rebase --continue</code>
<li>you will likely also need <code>git push --force-with-lease</code>
</ul>
</ul>

<h4>After hot fix merge rocBLAS master into develop</h4>
<ul>
    <li> <code>mkdir -p ~/repos/rocBLASmergeDevelop; cd ~/repos/rocBLAS_merge_develop</code></li>

    <li> <code>git clone https://github.com/ROCmSoftwarePlatform/rocBLAS.git</code></li>

    <li> <code>cd rocBLAS</code></li>
    <li> <code>git checkout master</code></li>
    <li> edit both bump_develop_version.sh and bump_master_version.sh</li>
    <li> <code>./bump_master_version.sh</code></li>
    <ul>
        <li> check changes are correct with    <code>git status</code> and look at CMakeLists.txt and other files.</li>
        <li> <code> git add -u</code></li>
        <li> <code>git commit -m"version for master branch release"</code></li>
    </ul>

    <li> <code>git checkout develop</code></li>
    <li> <code>git merge master</code></li>

    <li> fix merge conflict in CMakeList.txt, this is in place of<code>./bump_develop_version.sh</code></li>
    <ul>
        <li> check changes are correct with    <code>git status</code> and look at CMakeLists.txt and other files.</li>
        <li> <code> git add -u</code></li>
        <li> <code>git commit -m"version for develop branch release"</code></li>
    </ul>

    <li> <code>git push --all</code></li>
</ul>

<h2>Update version numbers and create release-staging/rocm-rel-x.x</h2>
<ul>
<li>make sure rocBLAS-internal:amcamd:develop is up-to-date with rocBLAS-internal:ROCmSoftwarePlatform:develop</li>
<li>make new branch rocBLAS-internal:ROCmSoftwarePlatform:release-staging/rocm-rel-x.x from rocBLAS-internal:ROCmSoftwarePlatform:develop</li>
<li><code>mkdir -p ~/repos/rocBLASmergeDevelop</code></li>
<li><code>cd ~/repos/rocBLASmergeDevelop; rm -rf rocBLAS-internal</code></li>
<li><code>git clone git@github.com:amcamd/rocBLAS-internal.git</code></li>
<li><code>cd rocBLAS-internal; git checkout develop</code></li>
<li><code>./bump_develop_version.sh</code></li>
<li>check that the rocBLAS version, rocblas_SOVERSION, Tensile version, and Tensile hash are correct</li>
<li><code>git add -u</code></li>
<li><code>git commit -m"develop branch for release after ROCm x.x"</code></li>
<li><code>git push</code></li>
<li><code>git checkout release-staging/rocm-rel-x.x</code></li>
<li><code>./bump_release-staging_version.sh</code></li>
<li>Check that the rocBLAS version, rocblas_SOVERSION, Tensile version, and Tensile hash are correct</li>
<li><code>git add -u</code></li>
<li><code>git commit -m"release-staging branch for ROCm x.x"</code></li>
<li><code>git push</code></li>
<li>make PRs for both the develop and release-staging/rocm-rel-x.x branches</li>
</ul>

<h2>(out of date)Merge rocBLAS develop into master and release</h2>
<h4>Get amcamd develop branch up to date with ROCmSoftwarePlatform</h4>
<ul>
	<li> <code>mkdir -p ~/repos/rocBLASmergeDevelop</code></li>
	<li> <code>cd ~/repos/rocBLASmergeDevelop; rm -rf rocBLAS</code></li>

    <li> <code>git clone https://github.com/amcamd/rocBLAS.git</code></li>

    <li> <code>cd rocBLAS; git checkout develop</code></li>

    <li><code>git remote add upstream https://github.com/ROCmSoftwarePlatform/rocBLAS.git</code></li>
    <li><code>git fetch upstream</code></li>
    <li><code>git rebase upstream/develop develop</code></li>
    <li><code>git status</code></li>
    <li><code>git push</code></li>
</ul>
<h4>Get amcamd master branch up to date with ROCmSoftwarePlatform</h4>
<ul>
    <li> <code>mkdir -p ~/repos/rocBLASmergeDevelop</code></li>
    <li> <code>cd ~/repos/rocBLASmergeDevelop; rm -rf rocBLAS</code></li>

    <li> <code>git clone https://github.com/amcamd/rocBLAS.git</code></li>

    <li> <code>cd rocBLAS; git checkout master</code></li>

    <li><code>git remote add upstream https://github.com/ROCmSoftwarePlatform/rocBLAS.git</code></li>
    <li><code>git fetch upstream</code></li>
    <li><code>git rebase upstream/master master</code></li>
    <li><code>git status</code></li>
    <li><code>git push</code></li>
</ul>

<h4>Merge master into develop and resolve merge conflicts</h4>
<ul>
    <li> <code>cd ~/repos/rocBLASmergeDevelop; rm -rf rocBLAS</code></li>
    <li> <code>git clone https://github.com/amcamd/rocBLAS.git</code></li>
    <li> <code>cd rocBLAS; git checkout develop </code></li>

    <li> <code>git merge origin/master</code></li>
    <li> resolve merge conflicts
    <li> <code>git commit -m"merge master into develop before ROCm2.10"</code></li>
    <li> <code>git push</code></li>
</ul>

<h4>Merge develop into master and merge all</h4>
<ul>
    <li> edit both bump_develop_version.sh and bump_master_version.sh</li>
    <li> <code>./bump_master_version.sh</code></li>
    <ul>
        <li> check changes are correct with    <code>git status</code> and look at CMakeLists.txt and other files.</li>
        <li> <code> git add -u</code></li>
        <li> <code>git commit -m"version for master branch release"</code></li>
    </ul>

    <li> <code>git checkout master</code></li>
    <li> <code>git merge develop</code></li>
    <li> <code>git checkout develop</code></li>
    <li> <code>git merge master --ff-only</code>  # getting the develop branch to include the new merge commit</li>

    <li> <code>./bump_develop_version.sh</code></li>
    <ul>
        <li> check changes are correct with    <code>git status</code> and look at CMakeLists.txt and other files.</li>
        <li> <code> git add -u</code></li>
        <li> <code>git commit -m"version for develop branch release"</code></li>
    </ul>

    <li> <code>git push --all</code></li>
</ul>

<h2>Merge hipBLAS develop into master and release</h2>

<h4>Note on version numbers for rocBLAS and hipBLAS</h4>
<ul>
	<li><a href="http://semver.org">Semantic Versioning</a> is used for version numbers. This uses MAJOR.MINOR.PATCH for version numbers.</li>
	<li>We also use the convention that the MINOR version number is even for the master branch and odd for the develop branch.</li>
	<li>rocBLAS and hipBLAS version numbers are in <code>VERSION_STRING</code> in the file CMakeLists.txt.</li>
	<li>The scripts <code>bump_master_version.sh</code> and <code>bump_develop_version.sh</code> are used to bump the version numbers.</li>
	<li><code>bump_master_version.sh</code> is run first, and it changes the version number from the existing odd number for the develop branch to the next even number for the master branch.</li>
	<li><code>bump_develop_version.sh</code> runs second, and it changes the version number from the new even number for the master branch to the next odd number for the develop branch.</li>
</ul>

<h4>Note on Tensile tag and version number</h4>
<ul>
	<li>The Tensile used by rocBLAS is from the tag in the file rocBLAS/tensile_tag.txt.</li>
	<li>The tag will generally be different for the develop and master versions of rocBLAS.</li>
	<li>The file rocBLAS/CMakeLists.txt also contains a Tensile version specified explicitly in a find_package command. Note that this is not the CMake variable TENSILE_VERSION, it is an immediate value.</li>
	<li>The Tensile version will generally change with each release of rocBLAS</li>
	<li>The Tensile group will supply a new Tensile version and Tensile tag</li>
	<li>The Tensile version and Tensile tag are changed by the scripts <code>bump_master_version.sh</code> and <code>bump_develop_version.sh</code>.
</ul>




<h4>Get amcamd develop branch up to date with ROCmSoftwarePlatform</h4>
<ul>
    <li> <code>mkdir -p ~/repos/hipBLASmergeDevelop</code></li>
    <li> <code>cd ~/repos/hipBLASmergeDevelop; rm -rf hipBLAS</code></li>

    <li> <code>git clone https://github.com/amcamd/hipBLAS.git</code></li>

    <li> <code>cd hipBLAS; git checkout develop</code></li>

    <li><code>git remote add upstream https://github.com/ROCmSoftwarePlatform/hipBLAS.git</code></li>
    <li><code>git fetch upstream</code></li>
    <li><code>git rebase upstream/develop develop</code></li>
    <li><code>git status; git push</code></li>
</ul>
<h4>Get amcamd master branch up to date with ROCmSoftwarePlatform</h4>
<ul>

    <li><code>cd ~/repos/hipBLASmergeDevelop; rm -rf hipBLAS</code></li>

    <li><code>git clone https://github.com/amcamd/hipBLAS.git</code></li>

    <li><code>cd hipBLAS; git checkout master</code></li>

    <li><code>git remote add upstream https://github.com/ROCmSoftwarePlatform/hipBLAS.git</code></li>
    <li><code>git fetch upstream</code></li>
    <li><code>git rebase upstream/master master</code></li>
    <li><code>git status</code></li>
    <li><code>git push</code></li>
</ul>
<h4>Merge master into develop and resolve merge conflicts</h4>
<ul>
    <li> <code>cd ~/repos/hipBLASmergeDevelop; rm -rf hipBLAS</code></li>
    <li> <code>git clone https://github.com/amcamd/hipBLAS.git</code></li>
    <li> <code>cd hipBLAS; git checkout develop</code></li>

    <li> <code>git merge origin/master</code></li>
    <li> resolve merge conflicts
    <li> <code>git commit -m"merge master into develop before ROCm2.10"</code></li>
    <li> <code>git push</code></li>
</ul>
<h4>Merge develop into master and merge all</h4>
<ul>
    <li> edit both bump_develop_version.sh and bump_master_version.sh</li>
    <li> <code>./bump_master_version.sh</code></li>
    <ul>
        <li> check changes are correct with    <code>git status</code> and look at CMakeLists.txt and other files.</li>
        <li> <code> git add -u</code></li>
        <li> <code>git commit -m"version for master branch release"</code></li>
    </ul>

    <li> <code>git checkout master</code></li>
    <li> <code>git merge develop</code></li>
    <li> <code>git checkout develop</code></li>
    <li> <code>git merge master --ff-only</code>  # getting the develop branch to include the new merge commit</li>

    <li> <code>./bump_develop_version.sh</code></li>
    <ul>
        <li> check changes are correct with    <code>git status</code> and look at CMakeLists.txt and other files.</li>
        <li> <code> git add -u</code></li>
        <li> <code>git commit -m"version for develop branch release"</code></li>
    </ul>

    <li> <code>git push --all</code></li>

</ul>


<h2>(out of date)Merge Tensile develop into master and release</h2>
<ul>
    <li> <code>mkdir -p ~/repos/Tensile_merge_develop; cd ~/repos/Tensile_merge_develop</code></li>

    <li> <code>git clone https://github.com/ROCmSoftwarePlatform/Tensile.git</code></li>

    <li> <code>cd Tensile</code></li>
    <li> <code>git checkout develop</code></li>
    <li> edit bump-version.h</li>
    <li> <code>./bump-version.sh</code></li>
    <ul>
        <li> check to see that Tensile/__init__.py has changed</li>
        <li> check version in .yaml files with  <code>grep MinimumRequiredVersion Tensile/Configs/*yaml</code></li>
        <li> <code>git add -u</code></li>
        <li> <code>git commit -m"change version for new release"</code></li>
    </ul>

    <li> <code>git checkout master</code></li>
    <li> <code>git merge develop</code></li>
    <li> <code>git checkout develop</code></li>
    <li> <code>git merge master --ff-only  # getting the develop branch to include the new merge commit</code></li>
    <li> check that there is the correct Tensile/__init__.py in develop and master</li>

    <li> <code>git push --all</code></li>

    <li> go to  https://github.com/ROCmSoftwarePlatform/Tensile.git</li>

    <li> under repository name click &lt;Releases&gt;</li>

    <li> click &lt;Draft a new release&gt;</li>
    <ul>
        <li> select MASTER branch</li>
        <li>enter <a href="http://semver.org">Semantic Versioning</a> version tag</li>
        <li>enter Title and notes</li>
        <li>add .deb and .rpm files from Jenkins.
            You may need to use Chrome browser in place of Firefox for adding .deb and .rpm.</li>
        <li> click &lt;Publish release&gt;</li>
    </ul>
</ul>

<h1>Useful commands</h1>
<p>find ./rocBLAS-develop -type f -exec grep -l gemv {} \; 


<h1>Timing with C++11</h1>
<pre>
#include &lt;chrono&gt;
  std::chrono::time_point&lt;std::chrono::high_resolution_clock&gt; start, end;
  std::chrono::duration&lt;double&gt;dur;
  hipDeviceSynchronize();
  start = std::chrono::high_resolution_clock::now();
    status = hcblasSgemm(handle, typeA, typeB, M, N, K, &amp;alpha, 
    d_A, lda, d_B, ldb, &amp;beta, d_C, ldc);
  hipDeviceSynchronize();
  end = std::chrono::high_resolution_clock::now();
  dur = end - start;
  double gemmSec= dur.count();

  printf("dur, gemmSec = %f, %f\n",dur, gemmSec);
  double gflops = (double)(M) * (double)(N) * (double)(K) * 2.0 / gemmSec / 1e9;
  printf("gflops = %f\n",gflops);


Alternative explicit cast to microseconds. Do not cast to seconds for jobs
running for &lt; 1sec, because it truncates so you will loose all precition
less than one second.
  double gemmSec2= chrono::duration_cast&lt;chrono::microseconds&gt;(end - start).count();

</pre>
The event timer can also be used. It gives results similar to C++11 chrono.
<pre>
#include &lt;hip/hip_runtime.h&gt;
#include &lt;hip/hip_runtime_api.h&gt;

  hipEvent_t hipStart, hipStop;
  hipEventCreate(&hipStart);
  hipEventCreate(&hipStop);

  hipEventRecord(hipStart);

  hipEventRecord(hipStop);

  float milliseconds = 0;
  hipEventElapsedTime(&milliseconds, hipStart, hipStop);

</pre>


<h1>ATITOOL (atitool)</h1>

<ul>
    <li>get atitool from
        <ul>
            <li><a href="http://gpudiagnostics/release">http://gpudiagnostics/release</a>
            <li>Click <code>diagnostic tools</code> button at top
            <li>Click <code>ATITool</code> link on left panel, download latest release
        </ul>
    <li>put fan on full
        <ul>
            <li><code>sudo ./atitool -fancontrol=1</code>
        </ul>

    <li>set clock to 1500MHz
        <ul>
            <li>set soc voltage first
                <ul>
                    <li><code>sudo ./atitool --vddcr_soc=1.1</code>
                </ul>
            <li>set clock
                <ul>
                    <li><code>sudo ./stitool --eng=1500</code>
                </ul>
        </ul>

    <li>disable DPM
        <ul>
            <li>sudo vi /etc/default/grub
            <li>add value <code>amdgpu.dpm=0"</code> to <code>GRUB_CMDLINE_LINUX_DEFAULT</code>
            <li><code>sudo update-grub</code>
            <li>restart your system</li>
        </ul>
</ul>



<h1>rocm-smi  (ROCm System Management Interface</h1>
<p>Run <code>rocm-smi --help</code> for information. Below commands set
the device 1 clock to level 7 (1000 Hz) before a command, and then resets to
default after command.
<pre>
rocm-smi -d 1 --setsclk 7
sleep 1
rocm-smi -d 1 -g

./rocblas_sgemm_example

#reset device 1 clock to default values
rocm-smi -d 1 -r
</pre>

<h1>Single user runlevel N S</h1>
<p>
The command <pre>runlevel</pre> will show the runlevel. To boot the machine in runlevel N S
edit /etc/default/grub to change from

<pre>
GRUB_CMDLINE_LINUX_DEFAULT="quiet splash"
#GRUB_TERMINAL=console
#GRUB_GFXMODE=640x480
</pre>

to 

<pre>
GRUB_CMDLINE_LINUX_DEFAULT="text single"
GRUB_TERMINAL=console
GRUB_GFXMODE=640x480
</pre>

Then run <pre>sudo update-grub</pre> Reboot, and the machine should come up with runlevel N S.
Reverse the changes to get back to runlevel N 2.
<p>
For Ubuntu 16 see
<a href="http://askubuntu.com/questions/788323/change-runlevel-on-16-04">http://askubuntu.com/questions/788323/change-runlevel-on-16-04</a><br>


<h1>Docker</h1>
<p>Docker contailers for Mainline and releases
http://rocm-dockers-list:8506/
<ul>
	<li><a href="http://rocm-dockers-list:8506/">Docker images for Mainline staging and other builds</a></li>
	<li>For mainline: compute-rocm-dkms-no-npi-hipclang</li>
	<li>For staging: compute-rocm-dkms-component-staging-mathlibs </li>
</ul>
</p>
<p>Other Docker containers
<ul>
    <li><a href="https://hub.docker.com/r/rocm/rocm-terminal/tags/">Released Docker for rocm/rocm-terminal</a><br></td>
</ul>
</p>

<p>Docker contailers for amcamd
<a href="https://cloud.docker.com/repository/docker/amcamd/amcamd_dockerhub/general">amcamd/amcamd_dockerhub</a>

<p>On Ubuntu machine, can log in with
<ul>
	<li><code>sudo docker login</code></li>
	<li> https://hub.docker.com  account is   amcamd</li>
</ul>
<p>To see all available docker images on machine 
<ul>
	<li><code>sudo docker images</code></li>
</ul>
</p>
<p>To see all running docker containers
<ul>
	<li>sudo docker ps -a</li>
</ul>
</p>
<p>For the error message below
<ul>
	<li><code>error creating overlay mount to /var/lib/docker/overlay2/...N.../merged: no such file or directory</code></li>
</ul>
<p>Try the following commands
<ul>
    <li><code>docker system df</code></li>
    <li><code>docker system prune</code></li>
    <li><code>docker system prune -a</code></li>
</ul></p>
<p>To attach to docker container
<ul>
	<li><code>sudo docker attach &lt;docker number&gt;</code></li>
</ul></p>
<p>To pull docker image sunway13/ubuntu14.04:promote-free-v2
<ul>
	<li><code>sudo docker pull sunway513/ubuntu14.04:promote-free-v2</code></li>
</ul></p>
<p>To run docker image sunway13/ubuntu14.04:promote-free-v2
<ul>
	<li><code>sudo docker run -it --rm --device "/dev/kfd" --device "/dev/dri" --group-add video sunway513/ubuntu14.04:promote-free-v2</code></li>
	<li><code>sudo docker run -it --rm --device "/dev/kfd" --device "/dev/dri" --group-add video rocm/rocm-terminal</code></li>
    <li><code>sudo docker run --name andrew -tid --ipc=host --cap-add=SYS_PTRACE --privileged --security-opt seccomp=unconfined --device=/dev/kfd --device=/dev/dri --group-add video --group-add 44 -v /home:/home compute-artifactory.amd.com:5000/rocm-plus-docker/compute-rocm-dkms-no-npi-hipclang:6132-STG1 /bin/bash || exit 1</code></li>
	<li><code>sudo docker run -it --network=host --device=/dev/kfd --device=/dev/dri --ipc=host --shm-size 16G --group-add video --cap-add=SYS_PTRACE --security-opt seccomp=unconfined -v $HOME/dockerx:/dockerx rocmqa/staging-stg2:8629-py3-ub18.04-mathlib-stg-daily-build-job74</code></li>
</ul></p>
<p>To remove a docker container, first get CONTAINER ID with 
<ul>
	<li><code>sudo docker ps -a</code></li>
	<li>Next use command <code>docker rm &lt;CONTAINER ID&gt;</code></li>
</ul></p>

<p>To connect to a running docker container

<ul>
    <li> first get <code>container</code> with: <code>sudo docker ps</code></li>
    <li> next use: <code>sudo docker exec -e COLUMNS="`tput cols`" -e LINES="`tput lines`" -ti container /bin/bash</code></li>
</ul>

<p>to copy a file to a docker container
<ul>
    <li> first get <code>container</code> with: <code>sudo docker ps</code></li>
    <li> next get <code>ID</code> with: <code>sudo docker inspect -f   '{{.Id}}' container</code></li>
    <li> copy file with: <code> sudo docker cp file_name ID:file_path_in_container</code></li>
</ul>

<h3>To commit a docker image as: sunway513/hipcaffe:rocblas</h3>
<pre>In another terminal on the host machine find the docker image #ID with: sudo docker ps

Commit the image ID with:
sudo docker commit #ID sunway513/hipcaffe:rocblas

Push to dockerhub repo with:
sudo docker push sunway513/hipcaffe:rocblas
</pre>

<h3>To open docker on jenkins-cuda-0</h3>

sudo docker run -it -u 1000:1000 --device=/dev/nvidiactl --device=/dev/nvidia0 --device=/dev/nvidia-uvm --device=/dev/nvidia-uvm-tools --volume-driver=nvidia-docker --volume=nvidia_driver_384.90:/usr/local/nvidia:ro  hipblas/build-hipblas-hip-artifactory:latest

<h3>To install hip on cuda machine</h3>
<pre>
wget -qO - http://packages.amd.com/rocm/apt/debian/rocm.gpg.key | sudo apt-key add -
sudo sh -c 'echo deb [arch=amd64] http://packages.amd.com/rocm/apt/debian/ xenial main > /etc/apt/sources.list.d/rocm.list'

sudo apt-get install hip_nvcc
</pre>
To get the developer-preview branch
<pre>
git clone -b developer-preview https://github.com/GPUOpen-ProfessionalCompute-Tools/HIP.git
cd HIP && mkdir build && cd build && cmake .. && sudo make install
</pre>

<h3>To install OpenCL</h3>

<p>Commands below are from the
<a href="https://github.com/RadeonOpenCompute/ROCm">ROCm site</a><br>

<pre>sudo apt-get install rocm rocm-opencl</pre>

<pre>sudo apt-get install rocm-opencl-dev</pre>

<h1>Artifactory</h1>

<p>
http://compute-artifactory.amd.com/artifactory/webapp/#/artifacts/browse/tree/General/deb-experimental-local
<p>
http://compute-artifactory.amd.com/artifactory/webapp/#/artifacts/browse/tree/General/rocm-docker-github/kknox/hcc/clang_tot_upgrade/hcc-lc-ubuntu-16.04

<p>
edit /etc/apt/sources.list.d/rocm.list

<p>
change
deb [arch=amd64] http://packages.amd.com/rocm/apt/debian/ xenial main

<p>
to something like
deb [arch=amd64] http://compute-artifactory.amd.com/rocm/apt/debian/ xcnial 
<p>
or
<p>
http://compute-artifactory.amd.com/artifactory/webapp/#/artifacts/browse/tree/General/rocm-release-1.6-deb/amd/rocm
<p>
or
<p>
deb [arch=amd64] http://compute-artifactory.amd.com/artifactory/list/rocm-release-1.6-deb/ xenial main
<p>
or
<p>
deb [arch=amd64] http://10.255.8.5/rocm/apt/debian/ xenial main

<h1>clang-format</h1>
<ul>
    <li><a href="https://confluence.amd.com/display/MLSE/Code+Formatting+and+Style+Guides">Cory's page on clang-format</a><br></li>
    <li><a href="https://dx13.co.uk/articles/2015/4/3/Setting-up-git-clang-format.html">Setting up git-clang-format</a><br></li>
    <li><a href="https://clang.llvm.org/docs/ClangFormatStyleOptions.html">clang-format style options</a><br></li>
    <li><a href="http://clang.llvm.org/docs/ClangFormat.html#vim-integration">clang-format VIM integration</a><br></li>
</ul>
Instructions for UBUNTU from Cory's page:
<ul>
    <li><code>output_directory=&lt;ENTER DESIRED DIRECTORY, try ~/bin &gt;</code></li>
    <li><code>workspace=$(mktemp -d)</code></li>
    <li><code>cd -- "$workspace"</code></li>
    <li><code>wget https://repo.radeon.com/rocm/apt/4.3.1/pool/main/l/llvm-amdgpu4.3.1/llvm-amdgpu4.3.1_13.0.0.21313.40301_amd64.deb</code></li>
    <li><code>ar x llvm-amdgpu4.3.1_13.0.0.21313.40301_amd64.deb data.tar.xz</code></li>
    <li><code>tar xJf data.tar.xz --strip-components=5 -C "$output_directory" ./opt/rocm-4.3.1/llvm/bin/clang-format</code></li>
    <li><code>rm -r -- "$workspace"</code></li>
    <li>edit environment variable $PATH so that it finds the correct clang-format<code></code></li>
</ul>
<ul>
    <li> To format a file: <code>clang-format -style=file -i <path_to_source_file></code>
    <li> To format at checkin: <code>./.githooks/install</code>
</ul>

<h1>Visual Studio Code</h1>
<ul>
    <li>to start, click on icon, or search for "Visual Studio Code"
    <li>directory .vscode is added
    <li>gear wheel brings up .vscode/launch.json file. Add the following to configurations in .vscode/launch.json</li>
    <li><pre> "args": [
                "./Tensile/Tensile/Configs/rocblas_sgemm_asm_single_kernel.yaml", "~/tensile-gen"
            ]</pre></li>
    <li>bug icon brings up debug view</li>
    <li>you need to be viewing the file Tensile.py when you start debugging</li>
</ul>

<h1>Downgrade Linux Kernel</h1>
<ul>
    <li>To get to grub menue press <code>Esc</code> or <code>Shift</code> while rebooting
    </li><li>select: Advanced options for Ubuntu
    </li><li>In grub menue, select previous kernel, and note names of more recent kernels
    </li><li>To make it easier to get to grub menue:
    <pre><code>sudo vim /etc/default/grub</code>
          comment out the lines 
          #GRUB_HIDDEN_TIMEOUT=0
          #GRUB_HIDDEN_TIMEOUT_QUIET=true
          run grub-update to update grub after editing
        </pre>
    </li><li>To list kernels: <code>dpkg -l | grep linux</code>
    </li><li>To remove kernels, follow steps below to purge header and image:
        <pre>
<code>sudo apt-get purge linux-headers-4.15.0-29-generic</code>
<code>sudo apt-get purge linux-image-4.15.0-29-generic</code>
        </pre>
    </li><li>To disable kernel updates:
<pre>
<code>sudo apt-mark hold linux-headers-4.13.0-45-generic linux-image-4.13.0-45-generic linux-image-extra-4.13.0-45-generic</code>
</pre>
    </li><li>To enable kernel updates:
<pre>
<code>sudo apt-mark unhold linux-headers-4.13.0-45-generic linux-image-4.13.0-45-generic linux-image-extra-4.13.0-45-generic</code>
</pre>
    </li><li> To see all packages on hold: <code>apt-mark showhold</code>
    </li>
</ul>

<h1>Upgrade Ubuntu version</h1>
<pre>
sudo apt-get update
sudo apt-get upgrade -y
sudo apt-get dist-upgrade
sudo do-release-upgrade
</pre>

<h1>Upgrade ROCm</h1>
<pre>
# you can check gpg key with
apt-key list

# if ROCm Release Manager key has expired,  update gpg key with
wget -qO - http://repo.radeon.com/rocm/apt/debian/rocm.gpg.key | sudo apt-key add -
echo 'deb [arch=amd64] http://repo.radeon.com/rocm/apt/debian/ xenial main' | sudo tee /etc/apt/sources.list.d/rocm.list

sudo apt update
sudo apt -y autoremove rocm-dkms
# I don't think hee next four did anything, but it's worth a shot to make sure all old installations were purged
sudo apt purge hsakmt-roct
sudo apt purge hakmt-roct-dev
sudo apt purge compute-firmware
sudo apt purge $(dpkg -l | grep 'kfd\|rocm' | grep linux | grep -v libc | awk '{print $2}')

#This was required
sudo dkms remove rock/1.7.137-ubuntu --all
sudo apt upgrade
sudo reboot

# After the reboot
sudo apt -y install rocm-dkms

#chedk the file /etc/adduser.conf, if it does not have lines below, add them
echo 'ADD_EXTRA_GROUPS=1' | sudo tee -a /etc/adduser.conf
echo 'EXTRA_GROUPS=video' | sudo tee -a /etc/adduser.conf

Check the file /etc/profile.d/rocm.sh, if it does not have below in PATH, add it
echo 'export PATH=$PATH:/opt/rocm/bin:/opt/rocm/profiler/binop/rocm/opencl/bin/x86_64' | sudo tee -a /etc/profile.d/rocm.sh

# you may need to add the following line to /etc/modprobe.d/amd.conf or /etc/modprobe.d/dkms.conf
options amdgpu exp_hw_support=1

sudo reboot
</pre>

<h1>Doxygen</h1>
<p><a href="http://www.doxygen.nl/manual/index.html">Doxygen manual, with information on formatting</a><br>
<dl>
    <dt>To install Doxygen:</dt>
    <dd><code>sudo apt-get install doxygen</code></dd>
    <dt>To generate documentation for source code</dt>
    <dd> <code>doxygen -g sample_text.conf</code></dd>
    <dt>To produce Doxygen output for a single file include/rocblas-functions.h:</dt>
    <dd><code>( cat sample_text.conf ; echo "INPUT=include/rocblas-functions.h" ) | doxygen -</code></dd>
</dl>
</p>

<h1>Read the Docs / Sphinx / Beath</h1>
<ol>
    <li>You need to set up a virtual environment to build the readthedocs files.
        <ol>
            <li><a href="https://docs.readthedocs.io/en/stable/development/install.html">Install readthedocs</a> (you do not need to install / run the web server)</li>
            <li>
                <ol>
                    <li><code>sudo apt-get update -y</code></li>
                    <li><code>sudo apt-get install build-essential</code></li>
                    <li><code>sudo apt-get install python3-dev python3-pip python3-setuptools</code></li>
                    <li><code>sudo apt-get install libxml2-dev libxslt1-dev zlib1g-dev</code></li>

                    <li><code>sudo apt-get install python3-pip</code></li>
                    <li><code>sudo pip3 install virtualenv</code></li>

                    <li><code>sudo apt-get install -y doxygen</code></li>
                    
                    <li><code>sudo apt-get install redis-server</code></li>
                    
                    <li><code>git clone --recurse-submodules https://github.com/readthedocs/readthedocs.org.git</code></li>
                    <li><code>cd readthedocs.org</code></li>
                    
                    <li><code>virtualenv --python=python3 venv</code></li>
                    <li><code>source venv/bin/activate</code></li>
                </ol>
            </li>
            <li>Install sphinx_rtd_theme via: $ <code>pip install sphinx_rtd_theme</code></li>
            <li>Install breathe (if rocBLAS is using breathe): $ <code>pip install breathe</code></li>
            <li>Execute the <code>./run_doc.sh</code> script</li>
            <li>Load ./docs/source/_build/html/index.html</li>
        </ol>
    </li>
    <li>For subsequent use after readthedocs has been installed:
        <ol>
            <li><code>virtualenv --python=python3 venv</code></li>
            <li><code>source venv/bin/activate</code></li>
            <li><code>pip install sphinx_rtd_theme</code></li>
            <li><code>pip install breathe</code></li>
            <li>Execute the ./run_doc.sh script</li>
            <li>Load ./docs/source/_build/html/index.html</li>
        </ol>
    </li>
    <li>
    To generate pdf:
        <ol>
            <li>add "make latexpdf" to the run_docs.sh script</li>
            <li>install latex with <code>sudo apt-get install latexmk texlive texlive-science texlive-formats-extra</code></li>
        </ol>
    <li>For rocSPARSE and rocALUTION, I am using my readthedocs account for the administratin. I have, however, created those projects and own them. Not sure about rocBLAS. You can access rocBLAS admin panel here. I think Saad has to add you as a maintainer.</li>
</ol>


<h1>Speeding up gtest (from Torre)</h1>

<ul>
    <li><a href="http://confluence.amd.com/pages/viewpage.action?spaceKey=~torrezuk&title=BLAS+Notes">Torre_Jira</a></li>
    <li><code>ln -s ../../../../clients/gtest/known_bugs.yaml known_bugs.yaml</code></li>
    <li><code>ln -s ../../../../clients/gtest/syrk_gtest.yaml syrk.yaml</code></li>
    <li><code>./rocblas-test --yaml syrk.yaml</code></li>
or
    <li><code>./rocblas-test --yaml blas1_gest.yaml --gtest_filter=*nrm2*</code><\li>
</ul>

<h1>Package dependencies</h1>
<ul>
    <li><code>apt list --installed</code> lists installed packages</li>
    <li><code>apt-cache depends hcc</code> lists dependencies for hcc</li>
</ul>

<h1>Viewing hip trace (from Torre)</h1>
<ul>
	<li>On Linux or Windows you will need chrome or chromium installed.</li>
	<li>Use the following command to generate results.* files: <code>/opt/rocm/bin/rocprof --obj-tracking on --hip-trace --timestamp --stats ./rocblas-bench -f gemm</code></li>
	<li>copy results.* files to subdirectory</li>
	<li>open chrome or chromium and go to address chrome://tracing</li>
	<li>click "load" button, and enter output file "results.json"</li>
	<li>use 'w' and 's' to zoom in and out</li>
	<li>zoom in and move the view untill the colored stripes expand and the profile can be seen</li>
</ul>

<h1>spell check in vim</h1>
<ul>
	<li><code>:setlocal spell</code> to turn on spelling.</li>
	<li><code>]s</code> to move to next word, <code>s[</code> to move to previous word.</li>
	<li><code>z=</code> to get suggested list of alternatives.</li>
	<li><code>zg</code> indicates misspelled word is correct.</li>
	<li><code>:set nospell</code> turns off spell check.</li>
	<li> </li>
</ul>

<h1>GlobalProtect VPN on Linux system</h1>
<ul>
<li> On the AMD network, you can use a Windows workstation to download the GlobalProtect client from file://atlislautwv01/GP_Linux with Google Chrome or copy it from \\atlislautwv01\GP_Linux using Windows File Explorer, and manually transfer it to your Linux workstation.</li>
<li> <code>tar -xvf PanGPLinux*.tgz</code></li>
<li> <code>sudo dpkg -i GlobalProtect_deb*.deb</code></li>
<li> <code>globalprotect</code></li>
<li> <code>&gt;&gt;connect -portal vpn.amd.com -username anchapman</code></li>
<li> <code>&gt;&gt;show --status</code></li>
<li> <code>&gt;&gt;disconnect</code></li>
<li> may need to verify phone at <a href="http://aka.ms/mfasetup">MFA Setup</a></li>
<li> if there are problems and messege "Cannot connect to local gpd service" it may be necessary to uninstall and reinstall with
    <ul>
    <li><code>sudo apt-get purge --auto-remove globalprotect</code></li>
    <li><code>cd ~/Downloads; sudo dpkg -i GlobalProtect_deb*.deb</code></li>
    </ul>
</ul>

<h1>SLURM commands</h1>
<ul>
	<li> <code>sinfo</code></li>
	<li> <code>salloc --ntasks=1</code></li>
	<li> <code>salloc --ntasks=1 --walltimne=24:00:00 --gres=gup:8 --ntasks-per-node=4 -- cpus-per-task=4</code></li>
	<li> use sbatch to submit batch script</li>
	<li> <pre>
	#/bin/bash
	#SBATCH --nodes=1
	#SBATCH --ntask-per-node=1
	#SBATCH	--gpus-per-node=8
	#SBATCH --output myjob_output</pre></li>
</ul>


<h1>Onboarding</h1>
<ul>
<li> <a href="http://confluence.amd.com/display/MLSE/Onboarding">On boarding</a>  </li> 
<li> <a href="http://confluence.amd.com/display/MLSE/Servers+for+Math+Libraries+Team">machines</a>  </li> 
<li> <a href="http://gitlab1.amd.com/TrainingCourses/hipCourse">coding examples</a>  </li> 
</ul>

<h1>Centos</h1>
<code>scl enable devtoolset-8 bash</code>

<h1>hipBLAS on Cuda</h1>
<ul>
<li><code>sudo docker run  --gpus 1 --name amcamd_syrkx -tid --ipc=host --cap-add=SYS_PTRACE --privileged --security-opt seccomp=unconfined --device=/dev/kfd --device=/dev/dri --group-add video --group-add 44 -v /home:/home compute-artifactory.amd.com:5000/rocm-plus-docker/compute-rocm-dkms-no-npi-hipclang:7202-ubuntu-20.04-cuda-11.x-stg1 /bin/bash || exit 1</code></li>
<li> alternative docker run command: <code> docker run --gpus 1 -v /home:/home -it compute-artifactory.amd.com:5000/rocm-plus-docker/compute-rocm-dkms-no-npi-hipclang:6870-ubuntu-20.04-cuda-11.x-stg1 bin/bash</code></li>
<li><code>sudo docker exec -e COLUMNS="`tput cols`" -e LINES="`tput lines`" -ti &lt;ID&gt; /bin/bash</code></li>
<li><code>apt-get update</code></li>
<li><code>apt install vim</code></li>
<li>comment out (library_dependencies_ubuntu+=("cuda")) in install.sh</li>
<li><code>apt install git</code></li>
<li><code>apt install gfortran</code></li>
<li><code>apt install cmake</code></li>
<li><code>ln -sf /opt/rocm* /opt/rocm</code></li>
<li><code>./install.sh -ndc --cuda</code></li>
</ul>

<h1>hipMAGMA</h1>
<ul>
<li><code>wget https://bitbucket.org/icl/magma/get/hipMAGMAv2.0.0.tar.gz</code> <ul><li>Copies tgz file</li></ul></li>
<li><code>gunzip hipMAGMAv2.0.0.tar.gz</code></li>
<li><code>tar -xvf hipMAGMAv2.0.0.tar</code></li>
<li><code>cp make.inc-examples/make.inc.hip_openblas make.inc</code> <ul><li>Creates a make.inc file from one of the examples, for example</li></ul></li>
<li><code>export OPENBLASDIR=/usr/lib/x86_64-linux-gnu/openblas</code> <ul><li>Check openblas is on your machine and indicate where it is</li></ul></li>
<li>Install hipblas and hipsparse if you are running tests with performance comparisons</li>
<li><code>make -f make.gen.hipMAGMA</code> <ul><li>Generates HIP-specific code by running</li></ul></li>
<li><code>make -f make.gen.hipMAGMA -j16 && make testing_hip/testing_dgemm -j16 && ./testing_hip/testing_dgemm</code>
    <ul><li>Builds library and a tester, and runs the tester</li></ul></li>
</ul>



<h1>hipBLAS on Cuda</h1>
<ul>
<li><code>sudo docker run  --gpus 1 --name amcamd_syrkx -tid --ipc=host --cap-add=SYS_PTRACE --privileged --security-opt seccomp=unconfined --device=/dev/kfd --device=/dev/dri --group-add video --group-add 44 -v /home:/home compute-artifactory.amd.com:5000/rocm-plus-docker/compute-rocm-dkms-no-npi-hipclang:7202-ubuntu-20.04-cuda-11.x-stg1 /bin/bash || exit 1</code></li>
<li><code>sudo docker exec -e COLUMNS="`tput cols`" -e LINES="`tput lines`" -ti &lt;ID&gt; /bin/bash</code></li>
<li><code>apt-get update</code></li>
<li><code>apt install vim</code></li>
<li>comment out (library_dependencies_ubuntu+=("cuda")) in install.sh</li>
<li><code>apt install git</code></li>
<li><code>apt install gfortran</code></li>
<li><code>apt install cmake</code></li>
<li><code>ln -sf /opt/rocm* /opt/rocm</code></li>
<li><code>./install.sh -ndc --cuda</code></li>
</ul>


<h1>Unified stack</h1>
<ul>
<li> <a href="https://confluence.amd.com/pages/viewpage.action?pageId=416619125">Linux Stack Unification</a>  </li> 
</ul>


<h1>GitHub Access</h1>
<ul>
<li> To request a user be added to a GitHub group, go to link: <a href="https://amd.service-now.com/nav_to.do?uri=%2Fcom.glideapp.servicecatalog_cat_item_view.do%3Fv%3D1%26sysparm_id%3Deb2a998b1be514d487852f8a2d4bcba3%26sysparm_link_parent%3De62ea8fd0a0a3c8600152c7fce6b82c4%26sysparm_catalog%3De0d08b13c3330100c8b837659bba8fb4%26sysparm_catalog_view%3Dcatalog_default%26sysparm_view%3Dtext_search">ServiceCentral</a>  </li> 
<li> Alternatively, start at: <a href="https://amd.service-now.com">AMD AskIT</a>; then search for GitHub in top right magnifying glass link.</li>
</ul>


</body>
</html>
